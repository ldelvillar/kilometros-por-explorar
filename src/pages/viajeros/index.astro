---
import { getCollection } from 'astro:content';
import Layout from '@/layouts/Layout.astro';
import FeaturedCustomerCard from '@/components/customers/FeaturedCustomerCard.astro';
import CustomerCard from '@/components/customers/CustomerCard.astro';
import { getWebPageSchema, getCombinedSchema } from '@/config/schemas';

const title = 'Historias de Viajeros Satisfechos | Kilómetros por Explorar';
const description =
  'Descubre las experiencias inolvidables de viajeros que organizaron sus viajes con nosotros. Explora sus aventuras y únete a la comunidad de viajeros felices con Kilómetros por Explorar.';
const pathname = Astro.url.pathname;
const pageSchema = getWebPageSchema(title, description, pathname);
const schema = getCombinedSchema(pageSchema);

const customers = await getCollection('customers');
const featuredCustomers = customers.filter(customer => customer.data.featured);
---

<Layout title={title} description={description} schema={schema}>
  <main id="main" class="animate-fade-in-up">
    <section class="mx-auto max-w-7xl px-4 pt-24 pb-6 lg:px-8">
      <h1 class="mb-2 text-4xl font-extrabold tracking-tight text-gray-800">
        Viajeros Satisfechos
      </h1>
      <p class="mb-8 text-lg leading-relaxed text-gray-600">
        Conoce historias de viajeros que han encontrado su destino ideal gracias
        a Kilómetros por Explorar.
      </p>

      <div
        class="grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-14 lg:grid-cols-3"
      >
        {
          featuredCustomers.map(customer => (
            <FeaturedCustomerCard customer={customer} loading="eager" />
          ))
        }
      </div>
    </section>

    <section class="mx-auto max-w-7xl px-4 pt-16 pb-6 lg:px-8">
      <h2 class="mb-6 text-4xl font-extrabold tracking-tight text-gray-800">
        Todas las historias
      </h2>
      <div
        class="grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-14 lg:grid-cols-3"
      >
        {
          customers.map(customer => (
            <CustomerCard customer={customer} loading="lazy" />
          ))
        }
      </div>
    </section>
  </main>
</Layout>
